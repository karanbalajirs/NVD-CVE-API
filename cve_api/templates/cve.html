{% load static %}
<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
        <script src="{% static 'js/bootstrap.min.js' %}"></script>
        
        <script>
            document.addEventListener("DOMContentLoaded", function() {
            var rows = document.querySelectorAll(".pri")
            rows.forEach(function(cell){
                var priority = cell.innerText.trim();

            switch (priority) {
            case "LOW":
                cell.classList.add("table-primary");
                break;
            case "MEDIUM":
                cell.classList.add("table-warning");
                break;
            case "HIGH":
                cell.classList.add("table-danger");
                break;
                }
            });

            var score  = document.querySelectorAll(".ari")
            score.forEach(function(cell){
                var priority = cell.innerText.trim();
            if( priority < 4.0 && priority >= 0.1)
                cell.classList.add("text-primary");
            else if( priority < 7.0 && priority >= 4.0 )
                cell.classList.add("text-warning");
            else if( priority >= 7.0)
                cell.classList.add("text-danger");
            });
            });
        </script>
    </head>
    <body>
        <div class="container-fluid" style="margin-top: 40px;">
        <h1>{{cve.id}}</h1>
        <hr>
        <h4>Description:</h4>
        <table class="table table-bordered ">
            <th scope="col">
                Language
            </th>
            <th scope="col">
                Value
            </th>
            {% for i in cve.description %}
            <tr >
                <td>{{i.lang}}</td>
                <td>{{i.value}}</td>
            </tr>
            {% endfor %}
        </table>
        
        {% if cve.metrics2 != null %}
        <hr>
        <h5>CVSS MetricV2</h5>
        {% for i in cve.metrics2.cvssMetricV2%}
            <table class="table  table-bordered ">
                <th scope="col">
                    source
                </th>
                <th scope="col">
                    type                    
                </th>
                <th scope="col">
                    cvssData
                </th>
                <th scope="col">
                    baseSeverity
                </th>
                <th scope="col">
                    exploitabilityScore
                </th>
                <th scope="col">
                    impactScore
                </th>
                <th scope="col">
                    acInsufInfo                 
                </th>
                <th scope="col">
                    obtainAllPrivilege
                </th>
                <th scope="col">
                    obtainUserPrivilege
                </th>
                <th scope="col">
                    obtainOtherPrivilege
                </th>
            {% if 'userInteractionRequired' in i %} 
                <th scope="col">
                    userInteractionRequired
                </th>
            {% endif %}
            <tr >
                <td>{{i.source}}</td>
                <td>{{i.type}}</td>
                <td>
                    <table class="table  table-bordered ">
                        <tr>
                        <th scope="col">version</th><td>{{i.cvssData.version}}</td></tr>
                        <tr><th scope="col">vectorString</th><td>{{i.cvssData.vectorString}}</td></tr>
                        <tr><th scope="col">accessVector</th><td>{{i.cvssData.accessVector}}</td></tr>
                        <tr><th scope="col" >accessComplexity</th><td class="pri">{{i.cvssData.accessComplexity}}</td>
                        </tr>
                        <tr><th scope="col">authentication</th><td>{{i.cvssData.authentication}}</td>
                        </tr>
                        <tr><th scope="col">confidentialityImpact</th><td>{{i.cvssData.confidentialityImpact}}</td>
                        </tr>
                        <tr><th scope="col">integrityImpact</th><td>{{i.cvssData.integrityImpact}}</td>
                        </tr>
                        <tr><th scope="col">availabilityImpact</th><td >{{i.cvssData.availabilityImpact}}</td>
                        </tr>
                        <tr><th scope="col">baseScore</th><td class="ari">{{i.cvssData.baseScore}}</td>
                        </tr>
                    </table>
                </td>
                <td class="pri">{{i.baseSeverity}}</td>
                <td class="ari">{{i.exploitabilityScore}}</td>
                <td class="ari">{{i.impactScore}}</td>
                <td>{{i.acInsufInfo}}</td>
                <td>{{i.obtainAllPrivilege}}</td>
                <td>{{i.obtainUserPrivilege}}</td>
                <td>{{i.obtainOtherPrivilege}}</td>
            {% if 'userInteractionRequired' in i %} 
                <td>
                    {{i.userInteractionRequired}}
                </td>
            {% endif %}
                
            </tr>    
            </table>
        {% endfor %}
        {% endif %}


        {% if cve.metrics30 != null %}
        <hr>
        <h5>CVSS MetricV30 </h5>
        {% for i in cve.metrics30.cvssMetricV30 %}
            <table class="table  table-bordered">
                <th scope="col">
                    source
                </th>
                <th scope="col">
                    type                    
                </th>
                <th scope="col">
                    cvssData
                </th>
                <th scope="col">
                    exploitabilityScore
                </th>
                <th scope="col">
                    impactScore
                </th>
            <tr >
                <td>{{i.source}}</td>
                <td>{{i.type}}</td>
                <td>
                    <table class="table table-bordered ">
                        <tr>
                        <th scope="col">version</th><td>{{i.cvssData.version}}</td></tr>
                        <tr><th scope="col">vectorString</th><td>{{i.cvssData.vectorString}}</td></tr>
                        <tr><th scope="col">attackVector</th><td>{{i.cvssData.attackVector}}</td></tr>
                        <tr><th scope="col" >attackComplexity</th><td class="pri">{{i.cvssData.attackComplexity}}</td>
                        </tr>
                        <tr><th scope="col">userInteraction</th><td>{{i.cvssData.userInteraction}}</td>
                        </tr>
                        <tr><th scope="col" >privilegesRequired</th><td class="pri">{{i.cvssData.privilegesRequired}}</td>
                        </tr>
                        <tr><th scope="col">scope</th><td>{{i.cvssData.scope}}</td>
                        </tr>
                        <tr><th scope="col" >confidentialityImpact</th><td class="pri"> {{i.cvssData.confidentialityImpact}}</td>
                        </tr>
                        <tr><th scope="col" >integrityImpact</th><td class="pri">{{i.cvssData.integrityImpact}}</td>
                        </tr>
                        <tr><th scope="col" >availabilityImpact</th><td class="pri">{{i.cvssData.availabilityImpact}}</td>
                        </tr>
                        <tr><th scope="col">baseScore</th><td class="ari">{{i.cvssData.baseScore}}</td>
                        </tr>
                        <tr><th scope="col"  >baseSeverity</th><td class="pri">{{i.cvssData.baseSeverity}}</td>
                        </tr>
                    </table>
                </td>
                <td class="ari">{{i.exploitabilityScore}}</td>
                <td class="ari">{{i.impactScore}}</td>
            {% if 'userInteractionRequired' in i %} 
                <td>
                    {{i.userInteractionRequired}}
                </td>
            {% endif %}
                
            </tr>    
            </table>
        {% endfor %}
        {% endif %}
        {% if cve.metrics31 != null %}
        <hr>
        <h5>CVSS MetricV31</h5>

        {% for i in cve.metrics31.cvssMetricV31 %}
            <table class="table  table-bordered ">
                <th scope="col">
                    source
                </th>
                <th scope="col">
                    type                    
                </th>
                <th scope="col">
                    cvssData
                </th>
                <th scope="col">
                    exploitabilityScore
                </th>
                <th scope="col">
                    impactScore
                </th>
            <tr >
                <td>{{i.source}}</td>
                <td>{{i.type}}</td>
                <td>
                    <table class="table  table-bordered">
                        <tr>
                        <th scope="col">version</th><td>{{i.cvssData.version}}</td></tr>
                        <tr><th scope="col">vectorString</th><td>{{i.cvssData.vectorString}}</td></tr>
                        <tr><th scope="col">attackVector</th><td >{{i.cvssData.attackVector}}</td></tr>
                        <tr><th scope="col">attackComplexity</th><td class="pri">{{i.cvssData.attackComplexity}}</td>
                        </tr>
                        <tr><th scope="col">userInteraction</th><td >{{i.cvssData.userInteraction}}</td>
                        </tr>
                        <tr><th scope="col">privilegesRequired</th><td class="pri">{{i.cvssData.privilegesRequired}}</td>
                        </tr>
                        <tr><th scope="col">scope</th><td>{{i.cvssData.scope}}</td>
                        </tr>
                        <tr><th scope="col">confidentialityImpact</th><td class="pri">{{i.cvssData.confidentialityImpact}}</td>
                        </tr>
                        <tr><th scope="col">integrityImpact</th><td class="pri">{{i.cvssData.integrityImpact}}</td>
                        </tr>
                        <tr><th scope="col">availabilityImpact</th><td class="pri">{{i.cvssData.availabilityImpact}}</td>
                        </tr>
                        <tr><th scope="col">baseScore</th><td class="ari">{{i.cvssData.baseScore}}</td>
                        </tr>
                        <tr><th scope="col">baseSeverity</th><td class="pri">{{i.cvssData.baseSeverity}}</td>
                        </tr>
                    </table>
                </td>
                <td class="ari">{{i.exploitabilityScore}}</td>
                <td class="ari">{{i.impactScore}}</td>
            {% if 'userInteractionRequired' in i %} 
                <td>
                    {{i.userInteractionRequired}}
                </td>
            {% endif %}
                
            </tr>    
            </table>
        {% endfor %}

        {% endif %}
    {% if cve.weaknesses != null %}
    <hr>
    <h5>Weaknesses</h5>
    <table class="table table-bordered"> 
        <th scope="col">source</th>
        <th scope="col">type</th>
        <th scope="col">Description</th>
    {% for i in cve.weaknesses %}
        <tr>
            <td>{{i.source}}</td>
            <td>{{i.type}}</td>
            <td>
                <table class="table table-bordered">
                    <th scope="col">lang</th>
                    <th scope="col">value</th>
                {% for j in i.description %}
                    <tr>
                        <td>{{j.lang}}</td>
                        <td>{{j.value}}</td>
                    </tr>    
                {% endfor %}
                </table>
            </td>
        </tr>
    {% endfor%}
    </table>
    {% endif %}
{% if cve.configurations != null %}
<hr>
<h5>Configurations</h5>
{% for i in cve.configurations %}
    <table class="table table-bordered">
    <th scope="col">Operator</th>
    <th scope="col">negate</th>
    <th scope="col">cpeMatch</th>
    {% for j in i.nodes %}
    <tr><td>{{j.operator}}</td>
        <td>{{j.negate}}</td>
        <td><table class="table table-bordered">
        <th scope="col">vulnerable</th>
        <th scope="col">criteria</th>
        <th scope="col">matchCriteriaId</th>
        {% for k in j.cpeMatch %}
        <tr><td>{{k.vulnerable}}</td>
            <td>{{k.criteria}}</td>
            <td>{{k.matchCriteriaId}}</td>
    </tr>
        {% endfor %}
        </table></td>
    </tr>
    {% endfor %}
    </table>
{% endfor %}
{% endif %}

{% if cve.references.0 != null %}
<hr>
<h5>References</h5>
    <table class="table table-bordered">
        <th scope="col">url</th>
        <th scope="col">source</th>
        {% for i in cve.references%}
        <tr>
            <td><a href="{{i.url}}">{{i.url}}</a></td>
            <td>{{i.source}}</td>
        </tr>
    {% endfor %}
    </table>
{% endif %}
    </div>
    </body>
</html>